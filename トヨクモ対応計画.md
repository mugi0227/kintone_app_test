# トヨクモ対応計画

## 1. 全体方針
- **kintone**: バックエンド。レコード定義・集計・API連携を担う。既存の `career-anchor-v3` フィールド構成を基に API トークン・権限を整備する。
- **FormBridge**: 診断フォームのフロントエンド。Q1〜Q40の回答、お気に入り3件の選択、即時の結果表示を FormBridge 側で実装し、送信時に kintone REST API へレコード登録する。
- **kViewer**: 結果閲覧用。kintone のレコードをもとに一覧/詳細を公開し、必要に応じてチャートやカード表示でリッチに閲覧できるようにする。

## 2. 作業ステップ
1. **要件確定**
   - FormBridgeで実現したい画面遷移・デザイン（設問レイアウト、ナビゲーション、結果カード）を確定。
   - kViewerで表示する項目（スコア、選択したお気に入り、コメント等）と公開範囲を決める。
2. **kintone整備**
   - `q1`〜`q40` と `favorite_*`、`score_*`、`career_type_result` を含んだアプリを作成。
   - REST API用ユーザー/トークンを発行し、FormBridgeからPOSTできるようにする。
   - サンプルレコードを登録しておき、kViewer／FormBridge双方のテストに使う。
3. **FormBridge実装**
   - フォームにQ1〜Q40のUIを配置し、カスタムJS/CSSで以下を実装:
     - 設問ナビゲーション（前へ/次へ）
     - 質問カード内のリッチUI（サンプル画像のような 1〜5 ボタンやラベルは CSS/JSで実現可能）
     - 診断ロジック（スコア計算、最高点の候補抽出、お気に入りの強制選択など）
     - 結果表示（Chart.js等を組み込む場合はFormBridge側に読み込ませる）
     - 送信時の kintone REST API 呼び出しとエラーハンドリング
4. **kViewerカスタマイズ**
   - kViewerで対象アプリを読み込み、一覧と詳細のテンプレートを作成。
   - カード/チャート表示を HTMLブロック＋CSSで整え、共有URLの設定を行う。
5. **統合テスト**
   - FormBridge → kintone → kViewer までの一連フローを通す。
   - バリデーション（未回答、お気に入り未選択、重複等）と権限を確認。
   - レコード数増加時のパフォーマンス、CSV出力など運用面を確認。
6. **リリース・ドキュメント**
   - 各設定手順、APIトークン、環境別URLをまとめたドキュメントを整備。
   - 運用フロー（入力、結果閲覧、データ抽出）を整理して共有する。

## 3. FormBridgeのUI自由度について
FormBridgeはHTML構造自体は制約がありますが、カスタムCSS/JavaScriptを追加できるため、以下のようなリッチUIは実現可能です。
- 設問カード（枠線・背景・影などをCSSで装飾）
- 1〜5のボタンをタイル状に並べ、クリックで値を送るインタラクション
- 「前へ戻る」「次へ進む」ボタンを任意位置に配置し、JavaScriptでページング制御
- 回答に応じた進捗バー、アニメーション、サマリー表示 など

提示されたラフ画像のような UI は FormBridge のカスタムJS/CSSで実装可能です。カスタムHTMLでボタン群を直接描画し、クリックイベントで隠しラジオ/hiddenフィールドへ値を反映する構成をとります。

## 4. 想定する成果物
- FormBridge設定ファイル（カスタムJS/CSS）
- kViewerテンプレート（HTML/CSS/必要なスクリプト）
- kintoneアプリ設定、APIトークン情報
- 操作マニュアルと運用フロー資料
