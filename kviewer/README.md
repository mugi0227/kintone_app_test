# kViewer 設定手順

このディレクトリには、kViewer でキャリアアンカー診断結果をリッチに表示するためのカスタマイズファイルが含まれています。
**HTMLテンプレートは使用せず、JavaScriptで画面を動的に生成します。**

## 1. 必要なファイル

以下のファイルを kViewer の設定画面からアップロード、または設定してください。

- `style.css`: CSSカスタマイズとしてアップロードします。
- `customize.js`: JavaScriptカスタマイズとしてアップロードします。
- `Chart.js`: グラフ描画ライブラリ。CDN またはファイルをアップロードして読み込みます。

## 2. 設定ステップ

### ステップ 1: ビューの作成
1. kViewer で「リストビュー」または「ダッシュボードビュー」を作成します。
2. データソースとして、キャリアアンカー診断アプリを選択します。
3. 詳細画面を表示する設定にします。

### ステップ 2: JavaScript / CSS の読み込み
1. ビューの編集画面で「カスタマイズ」タブを開きます。
2. **JavaScript**:
   - `Chart.js` (v4系推奨) をアップロード、または URL 指定します。
     - 例: `https://cdn.jsdelivr.net/npm/chart.js`
   - `customize.js` をアップロードします。
3. **CSS**:
   - `style.css` をアップロードします。

### ステップ 3: フィールドコードの確認とビューへの追加
**重要: 以下のフィールドを、kViewerのビュー設定（メインコンテンツ）に必ず追加してください。**
追加されていない場合、JavaScriptがデータを取得できず、グラフやスコアが表示されません。

- スコア: `score_tf`, `score_gm`, `score_au`, `score_se`, `score_ec`, `score_sv`, `score_ch`, `score_ls`
- お気に入り: `favorite_1`, `favorite_2`, `favorite_3`
- 日付: `作成日時` (または `Created_datetime`)

## 3. 動作確認
1. ビューを公開し、診断済みのレコード詳細画面を開きます。
2. JavaScript が自動的に実行され、デフォルトの表示が隠されて以下の要素が表示されることを確認します。
   - ヘッダー（診断日、タイプ名、説明文）
   - スコア内訳カード（左カラム）
   - レーダーチャート（右カラム）
   - お気に入りリスト（下部）

## トラブルシューティング
- **「設定エラー」が表示される**: 画面上部に赤字でエラーが表示される場合、メッセージに従って不足しているフィールドをビューに追加してください。
- **何も表示されない**: ブラウザのコンソール (F12 -> Console) を確認し、エラーが出ていないか確認してください。
- **デフォルトの表示と重なる**: `customize.js` 内で `.kv-detail` などの要素を非表示にする処理が動いているか確認してください。
- **チャートが表示されない**: Chart.js の読み込み順序が `customize.js` より前であることを確認してください。
