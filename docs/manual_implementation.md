# 実装マニュアル

このマニュアルでは、キャリアアンカー診断アプリケーションをゼロから構築する手順を説明します。
専門知識がない方でも、手順通りに進めれば実装できるように作成しています。

## 事前準備：必要なファイル
以下のファイルがお手元にあることを確認してください。

1.  `formbridge/js/customize.js` (FormBridge用プログラム)
2.  `formbridge/style.css` (FormBridge用デザイン)
3.  `kviewer/customize.js` (kViewer用プログラム)
4.  `kviewer/style.css` (kViewer用デザイン)

---

## ステップ1: kintoneアプリの作成

まず、データの保存先となるkintoneアプリを作成します。

1.  kintoneのポータル画面で「アプリを作成」をクリックし、「はじめから作成」を選びます。
2.  **フォームの作成**:
    *   以下のフィールドをドラッグ＆ドロップで配置してください。
    *   **重要**: 各フィールドの「設定」を開き、**「フィールドコード」**を以下のように正確に設定してください。（ここが間違っていると動きません）

| フィールドタイプ | フィールド名（ラベル） | **フィールドコード (必須)** | 備考 |
| :--- | :--- | :--- | :--- |
| ラジオボタン | 質問1 ～ 質問40 | `q_1` ～ `q_40` | 選択肢は「1, 2, 3, 4, 5」 |
| 文字列(1行) | お気に入り1 | `favorite_1` | |
| 文字列(1行) | お気に入り2 | `favorite_2` | |
| 文字列(1行) | お気に入り3 | `favorite_3` | |
| 文字列(複数行) | 診断結果テキスト | `career_type_result` | 診断結果の要約が保存されます |
| 日時 | 診断日時 | `diagnosis_date` | |
| 数値 | TFスコア | `score_tf` | |
| 数値 | GMスコア | `score_gm` | |
| 数値 | AUスコア | `score_au` | |
| 数値 | SEスコア | `score_se` | |
| 数値 | ECスコア | `score_ec` | |
| 数値 | SVスコア | `score_sv` | |
| 数値 | CHスコア | `score_ch` | |
| 数値 | LSスコア | `score_ls` | |

3.  アプリを「公開」します。
4.  **APIトークンの発行**:
    *   アプリ設定 > APIトークン を開き、「生成する」をクリックします。
    *   「レコード追加」にチェックを入れます。
    *   生成されたトークンをコピーしておきます（FormBridgeの設定で使います）。

---

## ステップ2: FormBridge（診断フォーム）の設定

1.  FormBridge管理画面で「フォーム作成」→「kintoneアプリから作成」を選びます。
2.  ステップ1で作ったkintoneアプリのURLを入力し、APIトークンを使って連携します。
3.  **フィールド設定**:
    *   **表示するフィールド**:
        *   `氏名` (またはユーザーを識別するフィールド)
        *   `diagnosis_date` (診断日時)
    *   **非表示にするフィールド**:
        *   `q_1` ～ `q_40`
        *   `favorite_1` ～ `favorite_3`
        *   `score_*` 系フィールドすべて
        *   `career_type_result`
    *   ※ これらの非表示フィールドは、プログラムが裏側で計算・保存するために使用します。
4.  **カスタマイズファイルのアップロード**:
    *   「カスタマイズ」タブを開きます。
    *   **JavaScript**: `formbridge/js/customize.js` をアップロードします。
    *   **CSS**: `formbridge/style.css` をアップロードします。
5.  「保存」して「公開」します。

---

## ステップ3: kViewer（結果閲覧画面）の設定

1.  kViewer管理画面で「ビュー作成」→「kintoneアプリから作成」を選びます。
2.  ステップ1のkintoneアプリを選び、「ダッシュボードビュー」または「リストビュー」を作成します（**リストビュー**推奨）。
3.  **メインコンテンツの設定**:
    *   「メインコンテンツ」タブで、以下のフィールドを**必ず「表示対象フィールド」に追加**してください。
    *   **必須リスト**:
        *   `score_tf`, `score_gm`, `score_au`, `score_se`, `score_ec`, `score_sv`, `score_ch`, `score_ls`
        *   `favorite_1`, `favorite_2`, `favorite_3`
        *   `diagnosis_date` (診断日時)
        *   `career_type_result` (診断結果テキスト)
    *   これらが追加されていないと、グラフが表示されません。
4.  **カスタマイズファイルのアップロード**:
    *   「カスタマイズ」タブを開きます。
    *   **JavaScript**:
        1.  `https://cdn.jsdelivr.net/npm/chart.js` (URL指定で追加)
        2.  `kviewer/customize.js` (アップロード)
        *   **重要**: 順番はこの通りにしてください。Chart.jsが先です。
    *   **CSS**: `kviewer/style.css` をアップロードします。
5.  「保存」して「公開」します。

---

## 完了確認
FormBridgeの公開URLを開き、診断を行ってください。
回答完了後、kViewerの画面に遷移し、レーダーチャートとスコアが表示されれば成功です。
