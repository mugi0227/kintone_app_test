# 保守・トラブルシューティングマニュアル

このマニュアルでは、アプリケーションが正常に動作しなくなった場合の対処法や、kintone/FormBridge/kViewerのアップデートに伴うメンテナンス方法について説明します。

## 1. トラブルシューティングの基本

「画面が真っ白になった」「グラフが出ない」などの問題が発生した場合、以下の手順で原因を特定します。

### 手順1: エラーメッセージの確認
ブラウザ（ChromeやEdge）には、開発者向けのエラーログを表示する機能があります。

1.  問題の画面を開いた状態で、キーボードの **F12キー** を押します。
2.  画面右側（または下側）に出てくるパネルの上部にある **「Console（コンソール）」** タブをクリックします。
3.  **赤文字** で表示されているメッセージがないか探します。

| よくあるエラー | 原因 | 対処法 |
| :--- | :--- | :--- |
| `Uncaught ReferenceError: Chart is not defined` | Chart.js が読み込まれていません。 | kViewerの設定で、`customize.js` より上に Chart.js のURLを追加してください。 |
| `[kViewer Customization] Missing fields...` | 必要なデータが足りません。 | kViewerのビュー設定で、スコアや日付フィールドを表示対象に追加してください。 |
| `Cannot read properties of null (reading 'value')` | フィールドコードが間違っています。 | kintoneアプリのフィールドコード設定を確認してください。 |

---

## 2. AIチャットを活用した改修方法

プログラミングの知識がなくても、ChatGPTやGeminiなどのAIチャットツールを使うことで、エラーの修正や機能の微調整を行うことができます。

### 手順1: エラー内容をAIに伝える
F12キーで表示されたエラーメッセージ（赤文字）をコピーし、AIに以下のように質問します。

> **プロンプト例:**
> 「kintoneとkViewerを使ったWebページで、以下のエラーが出て動きません。原因と対処法を教えてください。
> エラーメッセージ: [ここにエラーメッセージを貼り付け]」

### 手順2: コードを修正してもらう
エラーの原因が「プログラムの修正が必要」な場合（例：DOMのクラス名が変わったなど）、現在のコードをAIに渡して修正してもらいます。

> **プロンプト例:**
> 「現在使っているJavaScriptコードはこれです。
> [ここに customize.js の中身をすべて貼り付け]
>
> このコードを、[エラーの原因] に対応するように修正してください。
> 修正後のコード全体を出力してください。」

### 手順3: 修正されたコードを適用する
1.  AIが出力したコードをコピーします。
2.  手元の `customize.js` の中身を、コピーしたコードで**すべて上書き**します。
3.  上書きしたファイルを、FormBridgeまたはkViewerの設定画面から再度アップロードします。

---

## 3. アップデートで動かなくなった場合（DOM操作の修正）

kintoneやFormBridgeの仕様変更により、画面の部品（DOM）の名前が変わると、デザインが崩れたりボタンが消えたりすることがあります。

### 症状
-   「次へ」ボタンのデザインが急に標準のものに戻った。
-   特定の要素が表示されなくなった。

### 対処法（AIを使う場合）
1.  F12キーを押し、左上の矢印アイコン（要素選択ツール）で、対象のボタンやエリアをクリックします。
2.  表示されたHTMLコード（`<div class="...">` など）をコピーします。
3.  AIに以下のように聞きます。

> **プロンプト例:**
> 「FormBridgeの『次へ』ボタンのHTMLが、以前は `<div class="fb-next-button">` でしたが、現在は `[コピーしたHTML]` に変わっています。
> 私のJavaScriptコード（下記）を、新しいHTMLに対応するように修正してください。
> [ここに customize.js を貼り付け]」

---

## 4. 緊急時の復旧手順

どうしても直らない場合や、業務に支障が出る場合は、一時的にカスタマイズを無効化します。

1.  FormBridge または kViewer の管理画面を開きます。
2.  「カスタマイズ」タブを開きます。
3.  アップロードされている `customize.js` と `style.css` の横にある **「削除」** ボタン（または無効化スイッチ）を押します。
4.  「保存」して「公開」します。

これで、標準の（素っ気ないですが動作はする）画面に戻ります。この状態で業務を継続しつつ、原因調査を行ってください。
